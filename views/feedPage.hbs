  
{{#each events as |event|}}
<div class="row">
  <div class="col s12 m6">
    <div class="card blue-grey darken-1">
      <div class="card-content white-text">
        <span class="card-title">{{event.title}}</span>
        <p>{{event.description}}</p>
      </div>
      <div class="card-action">
        <a class="waves-effect waves-light btn orange modal-trigger" href="#/event/{{event._id}}"> Details </a>
        {{!-- <a href="/event/{{event._id}}">Details</a> --}}
        <a href="/{{event.author._id}}">Published: {{event.author.username}}</a>
      </div>
    </div>
  </div>
</div>
{{/each}}



{{!-- Modals --}}


{{!-- Modal Engine --}}

{{!-- Event Display Modal --}}
  <div class="modal" id="/event/{{event._id}}">
    <div class="modal-content">
      <h2>{{event.name}}</h2>
      <p>{{event.location.address}}</p>
      {{!-- <div id='map'></div> --}}
      <p>By {{event.author.name}}</p>
      <a href="/">Go back</a>
      <script>
        mapboxgl.accessToken = 'pk.eyJ1IjoiZGl1cml2aiIsImEiOiJjanAxdjA2cTQwMGp1M2tvYzZmZGp3bWc3In0.4cZEyLkU2ikqx_wb4A1z8A';
        const map = new mapboxgl.Map({
          container: 'map',
          style: 'mapbox://styles/mapbox/streets-v11',
          center: [{{ coordinates }}],
          zoom: 15
        });
        const marker = new mapboxgl.Marker({ color: 'red' })
        marker.setLngLat([{{ coordinates }}]).setPopup(new mapboxgl.Popup().setHTML(`<span>{{event.name}}</span>`)).addTo(map);
      </script>
    </div>
  </div>


{{!-- Mapbox --}}
{{!-- <script>
  mapboxgl.accessToken = 'pk.eyJ1IjoiZGl1cml2aiIsImEiOiJjanAxdjA2cTQwMGp1M2tvYzZmZGp3bWc3In0.4cZEyLkU2ikqx_wb4A1z8A';
  const map = new mapboxgl.Map({
    container: 'map',
    style: 'mapbox://styles/mapbox/streets-v11'
  });
  const geoCoder = new MapboxGeocoder({
    accessToken: mapboxgl.accessToken
  })
  map.addControl(geoCoder)
  geoCoder.on('results', (results) => {
    document.querySelector('#address').value = results.features[0].place_name
    document.querySelector('#lat').value = results.features[0].center[1];
    document.querySelector('#lng').value = results.features[0].center[0];
  });
</script> --}}

{{!-- Modal Engine --}}
<script>
  document.addEventListener('DOMContentLoaded', function () {
    let elements = document.querySelectorAll('.modal');
    let ins = M.Modal.init(elements);
  });
</script>